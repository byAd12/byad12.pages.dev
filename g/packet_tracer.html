<!--

Código por Adrián L. G. P.

~ Dedicatoria a: Ruth

-->

<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="Blog, Packet Tracer, Cisco, byAd12">
        <title>Packet Tracer - CLI</title>
        
        <link rel="stylesheet" type="text/css" href="../resources/blog.css">
    </head>
    <body>
        <!-- ......................................................... -->
        <!-- ......................................................... -->
        <div class="menu_bar" id="menu_bar">
            <!-- BARRA DE MENÚ -->
            <h1 class="logo" translate="no"><a href="../index.html">by<span>Ad</span>12</a></h1>
            <ul>
                <li><a href="../guides.html">~/Guías</a></li>
                <li class="ocultarMOVIL"><a onclick="esconder()">./Ocultar</a></li>
                <li><input type="color" class="NavColorCambiar" id="NavColorCambiar2" onchange="CambiarNavColorCodigo2()"></li>
            </ul>
        </div>

        <div class="gtranslate_wrapper" id="gtranslate_wrapper"></div>
        <script>window.gtranslateSettings = {"default_language":"es","native_language_names":true,"detect_browser_language":true,"languages":["es","en","de","gl","ru"],"globe_color":"#66aaff","wrapper_selector":".gtranslate_wrapper","flag_size":16,"horizontal_position":"left","vertical_position":"top","globe_size":20}</script>
        <script src="https://cdn.gtranslate.net/widgets/latest/globe.js" defer></script>
        <!-- ......................................................... -->
        <!-- ......................................................... -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/github-dark-dimmed.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/bash.min.js"></script>
        <script>hljs.highlightAll();</script>
        <!-- ......................................................... -->
        <!-- ......................................................... -->
        <div id="Principio"></div>
        <h1>Packet Tracer</h1>
        <h2 class="TituloSecundario">Command Line Interface</h2>
        <h2 class="TituloCreditosSuperior">Adrián L. G. P.</h2>
        <hr>
        <!-- ......................................................... -->
        <!-- ......................................................... -->
        <p style="color: black; position: sticky; top: 0;" id="dd"></p>
        
        <div class="parte1">
            <div>
                <h2>Formato</h2>

                <pre class="codigo" translate="no"><code class="cisco">prompt&gt;comando argumentos</code></pre>
                <p class="Expl"><b>prompt&gt;</b>: Indica el hostname del equipo que estamos configurando, a parte de si tenemos permisos: <span class="span_contenido">#</span>, o no: <span class="span_contenido">&gt;</span>.</p>
                <p class="Expl"><b>comando</b>: Comando a ejecutar.</p>
                <p class="Expl"><b>argumentos</b>: Antes de especificarlos una palabra clave o argumentos, se añade un espacio despúes del comando.</p>
            </div>
        </div>

        <div class="parte1">
            <div>
                <h2>Hostnames válidos</h2>

                <p><u>Reglas</u>: Comenzar con una letra. No contener espacios. Finalizar con letra o dígito. Utilizar únicamente letras, dígitos y guiones. Tener menos de 64 caracteres de longitud. <u>Ejemplo</u>:</p>
                <pre class="codigo" translate="no"><code class="cisco">Sw-Floor-1</code></pre>
                <p>Para poder cambiar el hostname de un equipo Cisco se usa:</p>
                <pre class="codigo" translate="no"><code class="cisco"># hostname &lt;Nombre&gt;</code></pre>
            </div>

            <div>
                <h2>Contraseñas válidas</h2>

                <p><u>Reglas</u>: Tener más de 8 caracteres de longitud. Combinaciones de letras, números y símbolos. Evitar el uso de la misma en varios dispositivos. No usar palabras comunes.</p>
                <p><u>Generador de contraseñas</u>: <a href="https://www.lastpass.com/es/features/password-generator" target="_blank">letpass.com</a></p>
            </div>
        </div>

        <hr>
        
        <div class="parte1">
            <div>
                <h2>Básico</h2>

                <p>Si escribimos un comando no válido intentará resolver ese texto como DNS. Este proceso lleva tiempo y se puede saltar mediante las teclas:</p>
                <pre class="codigo" translate="no"><code class="cisco">CTRL + BLOQ MAYUS + 6</code></pre>

                <p>Habilitar permisos de EXEC privilegiado en el equipo. El prompt se modificará de <span class="span_contenido">&gt;</span> a <span class="span_contenido">#</span>:</p>
                <pre class="codigo" translate="no"><code class="cisco">> enable</code></pre>

                <p>Muestra todos los comandos disponibles según donde te encuentres:</p>
                <pre class="codigo" translate="no"><code class="cisco"># ?</code></pre>
                <p class="Expl">Se puede poner un comando seguido de <span class="span_contenido">?</span> para enseñar sus palabras claves y atributos disponibles. Además puedes buscar una palabra completa poniendo la(s) letra(s) por la(s) que empieza seguido de <span class="span_contenido">?</span>.</p>
        
                <p>Para configurar la fecha y hora del equipo:</p>
                <pre class="codigo" translate="no"><code class="cisco"># clock set hora:min:seg día mes año</code></pre>
                <p class="Expl"><b>Mes</b>: Debe ser el nombre con letras y en inglés.</p>
                <p class="Expl">Luego podemos ver que hora tiene configurado el equipo con:</p>
                <pre class="codigo" translate="no"><code class="cisco"># show clock</code></pre>
            </div>

            <div>
                <h2>ICMP y acceso remoto</h2>

                <p>Enviar un paquete ICMP a un host de destino para verificar si responde:</p>
                <pre class="codigo" translate="no"><code class="cisco">ping &lt;IpDestino&gt;</code></pre>

                <p>Conectarmos mediante Secure Shell a un host remoto:</p>
                <pre class="codigo" translate="no"><code class="cisco">ssh -l &lt;Usuario&gt; &lt;IpDestino&gt;</code></pre>

                <p>Conectarmos mediante Telnet a un host remoto:</p>
                <pre class="codigo" translate="no"><code class="cisco">telnet (-l &lt;Usuario&gt;) &lt;IpDestino&gt;</code></pre>

                <p>Nota - <b>TELNET</b> y <b>SSH</b>:</p>
                <p class="Expl">Si en el router o switch que queremos conectarnos no tiene en las líneas <span class="span_contenido">vty 0 15</span> un <span class="span_contenido">password</span> y <span class="span_contenido">login</span>, el destino rechazará la conexión automáticamente.</p>
                <p>⚠️ Nota - Problema de seguridad en <b>TELNET</b>:</p>
                <p class="Expl">El tráfico de Telnet se envía en texto plano, incluyendo usuario y contraseña, lo que lo hace vulnerable a ataques <b>man-in-the-middle</b>. Demostración en Packet Tracer:</p>
                <p class="Expl">1. Entra en el <span class="span_contenido">Command Prompt</span> de un PC e inicia una conexión:</p>
                <pre class="codigo" translate="no"><code class="cisco">C:\> telnet (-l &lt;Usuario&gt;) &lt;IpDestino&gt;</code></pre>
                <p class="Expl">2. Antes de ingresar la contraseña, cambia Packet Tracer de <span class="span_contenido">Realtime</span> a <span class="span_contenido">Simulation</span>.</p>
                <p class="Expl">3. Se puede apreciar que por cada letra que tenga la contraseña se crea un paquete de parte del cliente. Abre a uno desde la sección <span class="span_contenido">Event List</span>.</p>
                <p class="Expl">4. En la nueva ventana pasa al modo <span class="span_contenido">Outbund PDU Details</span> y baja hasta el apartado <span class="span_contenido">TELNET</span>. Se puede ver que en cada paquete se enseña la letra enviada:</p>
                <pre class="codigo" translate="no"><code class="cisco">TELNET DATA:C</code></pre>
            </div>

            <div>
                <h2>Gestionar la memoria</h2>

                <p>Para ver las configuraciones del dispositivo debemos estar en la raíz del dispositivo y en modo EXEC privilegiado.</p>
                <br>
                <p>El siguiente comando nos permite ver configuraciones (interfaces, login y contraseñas) que están guardadas temporalmente y se eliminan al reiniciar el equipo:</p>
                <pre class="codigo" translate="no"><code class="cisco"># show running-config</code></pre>
                <p class="Expl">Para ver la configuración que persiste en NVRAM incluso al reiniciar el equipo:</p>
                <pre class="codigo" translate="no"><code class="cisco"># show startup-config</code></pre>
                <p>Para guardar la memoria temporal en NVRAM se utiliza <span class="span_contenido">wr</span> o:</p>
                <pre class="codigo" translate="no"><code class="cisco"># copy running-config startup-config</code></pre>
                <p>Para eliminar la memoria temporal se utiliza:</p>
                <pre class="codigo" translate="no"><code class="cisco"># reload</code></pre>
                <p>Por último, para eliminar la memoria NVRAM se utiliza:</p>
                <pre class="codigo" translate="no"><code class="cisco"># erase startup-config</code></pre>

            </div>

            <div>
                <h2>Configuraciones</h2>

                <p>Podemos entrar en modo de configuración global del dispositivo de 2 formas:</p>
                <pre class="codigo" translate="no"><code class="cisco"># configure terminal</code></pre>
                <pre class="codigo" translate="no"><code class="cisco"># config t</code></pre>

                <p>Podemos configurar un puerto de switch o una interfaz de red de router (solo si entramos en config anteriormente):</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# interface &lt;Interfaz&gt;&lt;Número&gt;</code></pre>
                <p class="Expl"><b>Interfaz</b> y <b>Número</b>: Podemos especificar un nombre completo como <span class="span_contenido">FastEthernet0/1</span> o su abreviatura como <span class="span_contenido">fa0/3</span>. 0/3 Significa que de la interfaz 0, se elige el puerto 3.</p>
                
                <p>Podemos asignar una descripción a cada interfaz:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# description &lt;Descripción&gt;</code></pre>

                <p>Para configurar parámetros de consola <span class="span_contenido">co</span>, SSH y Telnet <span class="span_contenido">vty</span> o acceso auxiliar:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# line &lt;co/vty&gt; &lt;Número/Rango&gt;</code></pre>
                <p class="Expl"><b>Número</b>: El número empieza desde 0 e identifica el puerto a configurar.
                                <b>Rango</b>: Si se quiere configurar varias líneas a la vez, como las 16 líneas de vty se usa un rango como: <span class="span_contenido">0 15</span>, con un espacio entre ambos números.</p>

                <p>Habilitar una interfaz después de realizar un cambio:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# no shutdown</code></pre>
                <p class="Expl">O deshabilitarla:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# shutdown</code></pre>

                <p>Podemos salir de cualquier modo de configuración al anterior. Ej. Si nos encontramos en (config-if) y enviamos este comando pasamos a (config):</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# exit
(config)# exit
# exit
> &lt;Comandos&gt;</code></pre>

                <p>O podemos salir de cualquier modo de configuración al modo inicial:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# end
# &lt;Comandos&gt;</code></pre>

            </div>

            <div>
                <h2>Ver información</h2>

                <p>Para ver todas las configuraciones de las interfaces del dispositivo en IPv4:</p>
                <pre class="codigo" translate="no"><code class="cisco">show ip interface brief</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">show ipv6 interface brief</code></pre>
                <p class="Expl">Enseña de cada interfaz el nombre, IP, Si está reconocida por el sistema (OK?), estado y protocolo. <u>Ejemplo</u>:</p>
                <pre class="codigo" translate="no"><code class="cisco">Router# show ip interface brief
Interface              IP-Address      OK? Method Status                Protocol
FastEthernet0/0        192.168.1.1     YES manual up                    up
FastEthernet0/1        unassigned      YES unset  administratively down down
Vlan1                  unassigned      YES unset  administratively down down</code></pre>

                <p>Para ver todas las estadísticas de todas las interfaces del equipo:</p>
                <pre class="codigo" translate="no"><code class="cisco">show interfaces</code></pre>
                <p class="Expl">Los siguientes muestran información de IPv4 o IPv6:</p>
                <pre class="codigo" translate="no"><code class="cisco">show ip interfaces</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">show ipv6 interfaces</code></pre>

                <p>Para ver la tabla de span_contenidos IPv4 o IPv6:</p>
                <pre class="codigo" translate="no"><code class="cisco">show ip route</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">show ipv6 route</code></pre>

                <p>Para ver la tabla ARP IPv4 o de vecinos IPv6:</p>
                <pre class="codigo" translate="no"><code class="cisco">show ip arp</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">show ipv6 neighbors</code></pre>

            </div>

            <div>
                <h2>Asignación de IP</h2>

                <p>Si es un <b>switch</b> hay que configurar IPs mediante VLANs se usa: (la VLAN por defecto es 1)</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# interface vlan NumVlan</code></pre>

                <p>Podemos asignar a una interfaz una IPv4 mediante:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# interface &lt;Interfaz&gt;&lt;Número&gt;</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# ip address &lt;IPv4&gt; &lt;Máscara&gt;</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# no shutdown</code></pre>

                <p>O además una IPv6:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# interface &lt;Interfaz&gt;&lt;Número&gt;</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# ipv6 address &lt;IPv6/Máscara&gt;</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# no shutdown</code></pre>
                <p>Si se trata de una dirección IPv6 LLA <span class="span_url">fe80::/10</span> se modifica el comando a:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# ipv6 address &lt;LLA_IPv6&gt; link-local</code></pre>
            </div>

            <div>
                <h2>Asignación del Default Gateway</h2>

                <p>Poner la IP de la puerta de enlace predeterminada a una interfaz:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# interface &lt;Interfaz&gt;&lt;Número&gt;</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# ip default-gateway &lt;IpGateway&gt;</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# no shutdown</code></pre>
            </div>

            <div>
                <h2>Permitir métodos de acceso remoto</h2>

                <p>Podemos permitir ciertos protocolos de acceso remoto con:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# line vty 0 15
(config-line)# transport input &lt;ssh telnet&gt;</code></pre>
                <p class="Expl">Podemos permitir tanto ssh y telnet o solo uno de los dos. Se separan mediante espacios.</p>

            </div>

            <div>
                <h2>Router - Enspan_contenidomiento estático</h2>

                <p>Para añadir una span_contenido a la que un router pueda acceder de manera manual:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# ip route &lt;IP_RedRemota&gt; &lt;Máscara_RedRemota&gt; &lt;IP_PróximoRouter&gt;</code></pre>
                <p class="Expl"><u>Nota</u>: Si la dirección de red o una IP cambia, debe modificarse la span_contenido manualmente.</p>
            </div>
            
            <div>
                <h2>Seguridad</h2>

                <p>Poner una contraseña en líneas de acceso:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# line &lt;console/vty&gt; &lt;NumPuerto/Rango&gt;</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-line)# password &lt;Contraseña&gt;</code></pre>
            
                <p>Para poner una contraseña al comando enable (<b>texto plano</b>):</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# enable password &lt;Contraseña&gt;</code></pre>
                <p class="Expl">Para ocultar la contraseña:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# service password-encryption</code></pre>
                <p class="Expl">Aunque oculta el contenido, se puede descifrar fácilmente debido a su débil cifrado con herramientas como <a href="https://www.firewall.cx/cisco/cisco-routers/cisco-type7-password-crack.html" target="_blank">firewall.cx</a>.</p>

                <p>Para poner una contraseña al comando enable (encriptando con <b>MD5</b>):</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# enable secret &lt;Contraseña&gt;</code></pre>
                <p class="Expl">Si se tenía <span class="span_contenido">enable password</span> anteriormente se ignorará y solo se usará <span class="span_contenido">enable secret</span>.</p>

                <p>Aplicar una política de usuario y contraseña: <span class="span_contenido">authentication</span>, o solo contraseña: <span class="span_contenido">local</span>:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-line)# login &lt;authentication/local&gt;</code></pre>

                <p>Poner un banner que se enseñara en la página de login:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# banner motd &lt;Carácter&gt;</code></pre>
                <p class="Expl"><b>Carácter</b>: Indicamos un carácter que no se vaya a repetir en el texto. Después de ejecutarlo pondrá un diálogo para poner un texto personalizado que verán al iniciar sesión. Acabaremos el comando con el carácter especificado y luego <span class="span_url">ENTER</span>.</p>
            
                <p>Bloquear un rango de puertos no usados:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# interface range &lt;Interfaz/Rango&gt;, &lt;Interfaz/Rango&gt;, ...</code></pre>
                <p class="Expl"><b>Interfaz/Rango</b>: Podemos seleccionar varios rangos de interfaces y aplicar los mismos cambios a todos. <u>Ejemplo</u>: <span class="span_contenido">F0/2-24, G0/2</span> (F0/2 a F0/24 y G0/2)</p>
                <pre class="codigo" translate="no"><code class="cisco">(config-if-range)# shutdown</code></pre>

            </div>
            
            <div>
                <h2>Creación y gestión de usuarios</h2>

                <p>Para crear un usuario <b>sin privilegios</b>:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# username &lt;Nombre_Usuario&gt; secret &lt;Contraseña&gt;</code></pre>
                
                <p>Para crear un usuario <b>con privilegios</b>:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# username &lt;Nombre_Usuario&gt; privilege &lt;TipoPrivilegio&gt; secret &lt;Contraseña&gt;</code></pre>
                <p class="Expl"><b>TipoPrivilegio</b>: Número del 0 al 15 que indica el nivel de privilegios que tendrá el usuario:<br><br>
                    - Del <span class="span_contenido">2</span> al <span class="span_contenido">14</span> son usuarios con permisos parciales.<br>
                    - El <span class="span_contenido">15</span> equivale al comando enable.<br>
                    - El <span class="span_contenido">1</span> equivale a un usuario normal.<br>
                    - El <span class="span_contenido">0</span> equivale a un acceso muy restringido.<br>
                </p>
                
                <p>Para aplicar una directiva de autentificación por usuario y contraseña:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# line vty 0 15</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# login local</code></pre>
            
            </div>
            
            <div>
                <h2>Directivas de seguridad</h2>

                <p>Para aplicar una longitud mínima a cada contraseña que se cree desde este momento (no se aplica a contraseñas ya creadas):</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# security passwords min-length &lt;NúmeroMínimo&gt;</code></pre>
                
                <p>Para cerrar la sesión de un usuario después de x minutos:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# line vty 0 15</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# exec-timeout &lt;Minutos&gt;</code></pre>
            
                <p>Bloquear a cualquier persona durante x minutos que no pueda iniciar sesión después de x intentos dentro de un período de x minutos:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# login block-for &lt;SegundosBloqueo&gt; attempts &lt;Intentos&gt; within &lt;PeriodoMinutos&gt;</code></pre>
            </div>
            
            <div>
                <h2>Permitir SSH</h2>

                <p>Pasos:</p>
                <p>1. Poner un hostname único y diferente al de por defecto.</p>
                
                <p>2. Asignar un nombre de dominio (ej. pargapondal.inf):</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# ip domain-name &lt;Dominio&gt;</code></pre>
                
                <p>3. Generar una clave de 4096 Bytes u otro tamaño con el algoritmo RSA:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# crypto key generate rsa general-keys modulus 4096</code></pre>
                
                <p>Permitir solo el tráfico SSH en las líneas de acceso remoto:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# line vty 0 15</code></pre>
                <pre class="codigo" translate="no"><code class="cisco">(config-if)# transport input ssh</code></pre>
                <p class="Expl">Desde el momento de poner el comando se denegará conexiones telnet, solo admitirá SSH. Si se tenía alguna conexión telnet existente no la cierra.</p>
            
            </div>
            
            <div>
                <h2>DNS</h2>

                <p>Asignar un nombre de dominio (ej. pargapondal.inf):</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# ip domain-name &lt;Dominio&gt;</code></pre>
                
                <p>Desactivar la búsqueda de DNS:</p>
                <pre class="codigo" translate="no"><code class="cisco">(config)# no ip domain-lookup</code></pre>
            
            </div>
            
        </div>
        <!-- ......................................................... -->
        <!-- ......................................................... -->
        <hr>
        <h2 class="TituloCreditosInferior"><a href="https://byAd12.pages.dev/guides" target="_blank">byAd12.pages.dev/guides</a></h2>
        <!-- ......................................................... -->
        <!-- ......................................................... -->
        <script src="../resources/blog.js"></script>
    </body>
</html>